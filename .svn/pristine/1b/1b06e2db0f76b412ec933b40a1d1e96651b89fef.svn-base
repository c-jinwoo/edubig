<%
/****************************************
    subject : 나의학습실
    summary : 나의학습실 > 나의 학습현황 
    author  : SANGS
    date    : 2018-06-15
****************************************/
%>
<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@ include file="/WEB-INF/jsp/ccedu/inc/taglib_inc.jsp"%>
<!DOCTYPE html>
<html lang="ko">
<head>
	<title>나의강의실 > 학습현황</title>
	<%@ include file="/WEB-INF/jsp/ccedu/inc/head_inc.jsp"%>

<script type="text/javascript">
	
	var aryCuserno  = new Array;	
	var aryCancelAt = new Array;
	var arySeqTitle = new Array;
	

	<c:forEach var="result" items="${listData}" varStatus="status">
	    aryCuserno.push('${result.CUSERNO}');
	    aryCancelAt.push('${result.CANCEL_AT}');
	    arySeqTitle.push('${result.SEQ_TITLE}');
	</c:forEach>

	$(document).ready(function(){
		$('#Allchk').click(function(){
			//클릭되었으면
	        if($(this).prop("checked")){
	            //input태그의 name이 chk인 태그들을 찾아서 checked옵션을 true로 정의
	            $("input[name=cancelChk]").prop("checked",true);
	            //클릭이 안되있으면
	        }else{
	            //input태그의 name이 chk인 태그들을 찾아서 checked옵션을 false로 정의
	            $("input[name=cancelChk]").prop("checked",false);
	        }

		});

		$("input[name=cancelChk]").click(function(){
			//클릭되었으면
	        if(!$(this).prop("checked")){
	            $('#Allchk').prop("checked",false);
	        }
		});

	});
	

	//페이지 이동
	function move_page(cPage){
		$('#cPage').val(cPage);
		$('form[name=frm]').attr('action', '<c:out value="${ctx}"/>/ccedu/myclass/learningStatusList.do').submit();
	} 

	//TAB 변경 
	function move_tab(ispass, tab){
		$('#ispass').val(ispass);
		$("#tab").val(tab);
		$('#cPage').val('1');
		$('form[name=frm]').attr('action', '<c:out value="${ctx}"/>/ccedu/myclass/learningStatusList.do').submit();
	}


	//강의실 이동
	function fnClassMove(courseno, searchCseqno){
		$('#courseno').val(courseno);
		$('#searchCseqno').val(searchCseqno);
		$('form[name=frm]').attr('action', '/ccedu/myclass/learningClassList.do').submit();
	}

	//수료증 출력 
	function fnPrint( cuserNo ){		
		$('#cuserNo').val(cuserNo);

		var w1 =1070;
		var h1 = 900;
		var url = "/academy/myclass/cerOnlinePrint.do";
		
		window.open( url+"?"+$("#frm").serialize()
			,"cert_pop","width="+w1+" height="+h1+", top=0, left=0, resizable=yes, status=no, menubar=no, toolbar=no, scrollbars=yes, location=no");
	}

	function fnCancel(){
		var chkAt = 0;
		var aryIdx = new Array;
		var aryCusernoIns = new Array;
		$("input[name=cancelChk]").each(function(idx){
	        if($(this).prop("checked")){
	        	
	        	aryIdx.push(idx);
	        	chkAt++;
	        }
		});


		if(chkAt > 0){
			fnConfirm("신청취소 하시겠습니까? " ,function(result){
				if(result){
					for(var i = 0; i < chkAt; i++){
						aryCusernoIns.push(aryCuserno[aryIdx[i]]);
						if(aryCancelAt[aryIdx[i]] == 'N'){
							fnModalMsg( "수강하신 '" + arySeqTitle[aryIdx[i]] +"'과정은<br/>신청취소가 불가합니다.");
							return false;
						}
					}

					$('#cuserNo').val(aryCusernoIns);

					$('form[name=frm]').attr('action', '/ccedu/myclass/del_course_exec.do').submit();
				}
			});
		} else {
			fnModalMsg("선택해주세요.");
		}		
	}	



</script>




</head>

<body>

<!-- skip nav -->
	<%@ include file="/WEB-INF/jsp/ccedu/inc/nav_inc.jsp"%>
<!--// skip nav -->


<div id="wrap">

	<!-- header -->
	<%@ include file="/WEB-INF/jsp/ccedu/inc/header_inc.jsp"%>
	<!--// header -->

	<!-- container -->
	<div id="container">

		<!-- location -->
		<jsp:include page="/WEB-INF/jsp/ccedu/inc/location/loc_06_01.jsp"> 
		  	<jsp:param name="menuNm" value="학습현황"/> 
		</jsp:include> 
		<!--// location -->

		<div class="con_center">

			<!-- lnb -->
			<div id="lnb">
				<jsp:include page="/WEB-INF/jsp/ccedu/inc/lnb/lnb_06.jsp"> 
				  	<jsp:param name="dep2" value="01"/>
				  	<jsp:param name="dep3" value="02"/>
				</jsp:include> 
			</div>
			<!--// lnb -->
			<!-- content 본문 -->
			<div id="content">

				<!-- layer pop 수료증 출력안내 -->
				<div class="layerpop print" tabindex="0" data-tooltip-con="guide01" data-focus="guide01" data-focus-prev="guide01-close">
					<div class="layer_mask tooltip-close"></div><!-- 블랙mask영역 -->
					<div class="layer_cont">
						<div class="lc_head">
							<h4 class="lc_tit">수료증 출력 안내</h4>
						</div>
						<div class="lc_cont">

							<ol class="pop_step">
								<li>
									<p><span class="ico_num">1<span>.</span></span> 수료증 최상단 빈 공간에서 마우스 오른쪽 클릭 &gt; <em class="color_orange">인쇄미리보기</em> 선택 </p>
									<div class="step_img"><img src="/cmmn/images/sub/img_print_step01.jpg" alt="PC 익스웹브라우저중 수료증위에 마우스 우측클릭한다음 인쇄미리보기를 선택하는 화면" /></div>
								</li>
								<li>
									<p><span class="ico_num">2<span>.</span></span> <em class="color_orange">페이지 설정 버튼 클릭</em>하여 아래와 동일하게 설정</p>
									<ol>
										<li>
											* 용지옵션
											<ol>
												<li>1. 가로</li>
												<li class="color_orange">2. 배경색 및 이미지 인쇄(C) 체크</li>
												<li>3. 크기에맞게 축소사용(S) 체크</li>
											</ol>
										</li>
										<li>
											* 여백(밀리미터)
											<ol>
												<li>1. 왼쪽, 오른쪽, 위쪽,아래쪽 모두 0으로 설정</li>
											</ol>
										</li>
										<li>
											* 머리글 / 바닥글
											<ol>
												<li>1. 모두 - 비어 있음 - 선택</li>
											</ol>
										</li>
									</ol>
									<div class="step_img"><img src="/cmmn/images/sub/img_print_step02.jpg" alt="인쇄미리보기 화면중 페이지 설정하는 화면" /></div>
								</li>
								<li>
									<p><span class="ico_num">3<span>.</span></span> 상단의 <em class="color_orange">인쇄버튼</em>을 눌러인쇄 </p>
									<div class="step_img"><img src="/cmmn/images/sub/img_print_step03.jpg" alt="인쇄버튼을 누르는 화면" /></div>
								</li>
							</ol>

						</div>
					</div>
					<button class="btn_close tooltip-close" data-focus="guide01-close" data-focus-next="guide01">닫기</button>
				</div>
				<!--// layer pop -->
				
				
				<!-- 기존 START 2018-08-30  -->
<!-- 				<h3 class="cont_titile">학습현황</h3> -->
				<!-- 기존 END 2018-08-30  -->
				
				<!-- 2018-08-28 김동인 작업 S --> 
				<h3 class="cont_titile type06">학습현황<span></span></h3>
				<!-- 2018-08-28 김동인 작업 E -->
				
				<!-- 본문내용 -->
				<div class="cont_body">
					<!-- start -->

					<div class="c_section">
						
						<div class="c_tab_link">
							<ul>
								<li><a href="#none" onclick="move_tab('N', 'R')" <c:if test="${REQUEST_DATA.tab eq 'R'}"> class="on" title="현재페이지" </c:if>>수강대기 강좌</a></li>
								<li><a href="#none" onclick="move_tab('N', 'O')" <c:if test="${REQUEST_DATA.tab eq 'O'}"> class="on" title="현재페이지" </c:if>>수강중인 강좌</a></li>
								<li><a href="#none" onclick="move_tab('Y', 'C')" <c:if test="${REQUEST_DATA.tab eq 'C'}"> class="on" title="현재페이지" </c:if>>수강완료 강좌 </a></li>
							</ul>
						</div>

						<!-- <ul class="c_txtlist">
							<li>수강하신 과정은 신청취소가 불가합니다.</li>
							<li>각 과정별 수료기준을 충족하면 수료증이 발급됩니다.</li>
						</ul> -->

						<!-- 수강완료 강좌 -->
						<c:if test="${REQUEST_DATA.ispass eq 'Y'}">
							<div class="c_btn_right02 mgt0">
								<button class="btn_ctl line_top_btn" data-tooltip="guide01">수료증 출력 안내</button>
							</div>
						</c:if>


						<div class="table_style_col">
							<form name="frm" id="frm" action="" method="post">
								<input type="hidden" name="cPage" id="cPage" value="<c:out value="${REQUEST_DATA.cPage}"/>"/>
								<input type="hidden" name="cuserNo" id="cuserNo" value=""/>
								<input type="hidden" name="courseno" id="courseno" value=""/>
								<input type="hidden" name="searchCseqno" id="searchCseqno" value=""/>
								<input type="hidden" name="ispass" id="ispass" value="<c:out value="${REQUEST_DATA.ispass}" default ='N'/>"/>
								<input type="hidden" name="tab" id="tab" value="" />
							
								<table>
									<caption>전체선택, 번호, 과정명, 진도율, 수료기준, 학습 등 항목을 확인 할 수 있는 표 입니다.</caption>
									<colgroup>
										<!-- 수강대기 강좌 -->
										<c:if test="${REQUEST_DATA.tab eq 'R'}">
											<col width="20%"/>
											<col width=""/>
											<col width="30%"/>
										</c:if>
										<!-- 수강중인 강좌 -->
										<c:if test="${REQUEST_DATA.tab eq 'O'}">
											<col width="20%"/>
											<col width=""/>
											<col width="20%"/>
											<col width="8%"/>
											<col width="10%"/>
										</c:if>
										<!-- 수강완료 강좌 -->
										<c:if test="${REQUEST_DATA.tab eq 'C'}">
											<col width="20%"/>
											<col width=""/>
											<col width="30%"/>
										</c:if>
									</colgroup>
									<thead>
										<tr>
											<!-- 수강대기 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'R'}">
												<th scope="col">과정구분</th>
												<th scope="col">과정명</th>
												<th scope="col">수강기간</th>
											</c:if>
											<!-- 수강중인 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'O'}">
												<th scope="col">과정구분</th>
												<th scope="col">과정명</th>
												<th scope="col">수강기간</th>
												<th scope="col">진도율</th>
												<th scope="col" class="btn_col">학습</th>
											</c:if>

											<!-- 수강완료 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'C'}">
												<th scope="col">과정구분</th>
												<th scope="col">과정명</th>
												<th scope="col">수강기간</th>
												<!-- <th scope="col" class="btn_col">수료증</th> -->
											</c:if>
										</tr>
									</thead>
									<tbody>
										<c:forEach var="result" items="${listData}" varStatus="status">
											<!-- 수강대기 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'R'}">
												<tr>
													<td class="align_center"><c:out value="${result.MT_SC_NAME}"/></td>
													<td><c:out value="${result.SEQ_TITLE}"/></td>
													<td class="align_center"><c:out value="${result.STARTDATE}"/> ~ <c:out value="${result.ENDDATE}"/></td>
												</tr>
											</c:if>
											<!-- 수강중인 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'O'}">
												<tr>
													<td class="align_center"><c:out value="${result.MT_SC_NAME}"/></td>
													<td><c:out value="${result.SEQ_TITLE}"/></td>
													<td class="align_center"><c:out value="${result.STARTDATE}"/> ~ <c:out value="${result.ENDDATE}"/></td>
													<td class="align_center"><c:out value="${result.PROGRESS_AVG}"/> %</td>
													<td class="align_center">
														<button onclick="fnClassMove('<c:out value="${result.COURSENO}"/>','<c:out value="${result.CSEQNO}"/>')" class="btn_blueline mobile_ico_book">강의실</button>
													</td>
													<%-- <td class="align_center">
														<c:if test="${result.ISPASS eq 'Y'}">
															<a href="#none" onclick="fnPrint('${result.CUSERNO}')"  title="새창으로 열립니다." class="btn_bluebg  mobile_ico_print">수료증</a>
														</c:if>
														<c:if test="${result.ISPASS ne 'Y'}">														
															<button onclick="fnClassMove('<c:out value="${result.COURSENO}"/>','<c:out value="${result.CSEQNO}"/>')" class="btn_blueline mobile_ico_book">강의실</button>
														</c:if>
													</td> --%> 
												</tr>
											</c:if>
											<!-- 수강완료 강좌 -->
											<c:if test="${REQUEST_DATA.tab eq 'C'}">
												<tr>
													<td class="align_center"><c:out value="${result.MT_SC_NAME}"/></td>
													<td><c:out value="${result.SEQ_TITLE}"/></td>
													<td class="align_center"><c:out value="${result.STARTDATE}"/> ~ <c:out value="${result.ENDDATE}"/></td>
													<%-- <td class="align_center">
														<c:if test="${result.ISPASS eq 'Y'}">
															<a href="#none" onclick="fnPrint('${result.CUSERNO}')"  title="새창으로 열립니다." class="btn_bluebg  mobile_ico_print">수료증</a>
														</c:if>
													</td> --%>
												</tr>
											</c:if>
										</c:forEach>
										<c:if test="${empty listData}">
											<tr>
												<!-- 수강대기 강좌 -->
												<c:if test="${REQUEST_DATA.tab eq 'R'}">
													<td colspan="3" class="align_center">수강대기 강좌가 없습니다.</td>
												</c:if>
												<!-- 수강중인 강좌 -->
												<c:if test="${REQUEST_DATA.tab eq 'O'}">
													<td colspan="5" class="align_center">수강중인 강좌가 없습니다.</td>
												</c:if>
												<!-- 수강완료 강좌 -->
												<c:if test="${REQUEST_DATA.tab eq 'C'}">
													<td colspan="4" class="align_center">수강완료 강좌가 없습니다.</td>
												</c:if>
											</tr>
										</c:if>
									</tbody>
								</table>
							</form>
						</div>

						<%-- <c:if test="${not empty listData}">
							<div class="paging">
								<paging:page cpage="${REQUEST_DATA.cPage}" total="${resultCount}" pageSize="${REQUEST_DATA.rowCount}" link="javascript:move_page"/>
							</div>
							<!-- 수강중인 강좌 -->
							<c:if test="${REQUEST_DATA.ispass ne 'Y'}">
								<div class="c_btn_right03">
									<button onclick="fnCancel();" class="btn_blueline03">신청취소</button>
								</div>
							</c:if>
						</c:if> --%>

					</div>

					<!--// end -->
				</div>
				<!--// 본문내용 -->
				
			<!--  -->
			</div>
			<!--// content 본문 -->

		
		</div>
	</div>
	<!--// container -->

	<!-- foot -->
	<%@ include file="/WEB-INF/jsp/ccedu/inc/footer_inc.jsp"%>
	<!--// foot end -->

</div>

</body>
</html>